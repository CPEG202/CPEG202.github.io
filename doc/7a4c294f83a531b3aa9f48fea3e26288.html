<font size='18'>
 <a href='../index.html'>Home</a>
 </font>
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="Tinghui WANG" name="Author"/>
<link href="/images/realdigital.ico" rel="icon" type="image/x-icon"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Welcome to Real Digital</title>
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs2015.min.css" rel="stylesheet"/>
<link href="/build/realdigital.c5563abade9aec1d0accf0b1c31118b8.css" rel="stylesheet"/>
<link href="/build/css/app.381c5c1b85ba6633fac439a6eb0ba6f4.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-52236215-2', 'auto');
        ga('send', 'pageview');
    </script>
</link></link></head>
<body class="doc-page">

<div class="wrapper">
<div class="main main-raised">
<article class="container-fluid">
<div class="row">
<div class="col col-main-content" id="doc-main-content">

<div>
<div class="title-box">
<h1>Project
                                    4.2
                                            Mux and Demux: A Simple Transmission System
            </h1>
<h2>Basic Combinational Blocks</h2>
</div>
<div class="row mt-3">
<div class="col text-left">
<a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license">
<img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" style="border-width:0"/>
</a>
</div>
<div class="col text-right">
<i class="fa fa-eye"></i>
                658
            </div>
</div>
</div>
<h2 data-source-line="1" id="introduction">Introduction</h2>
<p data-source-line="3">In this project, you will design a 4-to-1 mux and a decoder with an enable signal as a “de-mux” to implement a simple serial data transmitter. Both mux and de-mux will be implemented in two Verilog files for future re-use. Another Verilog file will be used to wrap up the mux and de-mux to form a communication system. This hierarchical design methodology will help manage design complexity, promote design reuse, and allow parallel development.</p>
<div class="row"><div class="col-md-6"><h4 id="before-you-begin-you-should">Before you begin, you should:</h4>
<ul>
<li>Have Real Digital®’s Blackboard set up;</li>
<li>Have the Xilinx® Vivado WebPACK™ installed;</li>
<li>Know how to write behavioral Verilog HDL code and write XDC files;</li>
<li>Get familiar with <a class="btn btn-sm btn-primary" href="https://www.realdigital.org/doc/467498beab847d9c7668cb472212960d "><strong>General Project Submission Policy</strong></a>;</li>
<li>Download <a class="btn btn-sm btn-orange" href="/downloads/6b66f2b34ae16e36121da550ad98679c.pdf"><strong>Submission Form 4</strong></a> <a class="btn btn-sm btn-orange" href="/downloads/ec70cfeb429bcb62be4be6da9112a37b.pdf	"><strong>Problem Set 4</strong></a>.</li>
</ul>
</div><div class="col-lg-6 col-md-6 col-sm-12"><h4 id="after-youre-done-you-should">After you’re done, you should:</h4>
<ul>
<li>Know how to instantiate circuit blocks described in other Verilog files;</li>
<li>Know how to implement a system using hierarchical design methodology.</li>
</ul>
</div></div><h2 data-source-line="20" id="background">Background</h2>
<div class="row"><div class="col-md-7"><p>Before starting with this project, read through the topics listed, understand how time-multiplexing communication system using multiplexer and de-multiplexer works because you will be creating your own communication system.</p>
</div><div class="col-lg-5 col-md-6 col-sm-12"><ul>
<li><a class="btn btn-sm btn-success" href="/doc/dacc40ac1ae11d10eb7304a317749403"><strong>Multiplexers</strong></a></li>
<li><a class="btn btn-sm btn-success" href="/doc/d4ffc6bac6d8e1e17babba2fe3e88e30"><strong>Binary Decoders</strong></a></li>
</ul>
</div></div><h2 data-source-line="31" id="step-1-create-a-new-project">Step 1: Create a New Project</h2>
<p data-source-line="32">Create a project in Xilinx Vivado targeting the <strong>Blackboard</strong>, as you have done in previous projects.</p>
<h2 data-source-line="34" id="step-2-implement-a-4-to-1-multiplexer">Step 2: Implement a 4-to-1 Multiplexer</h2>
<div class="row"><div class="col-md-9"><p>In this step, you need to implement a 4-to-1 Multiplexer named <code>mux</code> that will pass one of the four inputs <code>I0</code>, <code>I1</code>, <code>I2</code>, or <code>I3</code> to output <code>Y</code>based on the select signals <code>S0</code> and <code>S1</code>. The declaration of the module is as follows:</p>
<pre><code class="hljs language-verilog"><span class="hljs-keyword">module</span> mux (
    I0, I1, I2, I3, S0, S1, Y
);

<span class="hljs-keyword">input</span> I0, I1, I2, I3, S0, S1;
<span class="hljs-keyword">output</span> <span class="hljs-keyword">reg</span> Y;

<span class="hljs-comment">// Your behavioral description of Y</span>
<span class="hljs-comment">// using if-else or case statements</span>

<span class="hljs-keyword">endmodule</span>
</code></pre>
</div><div class="col-lg-3"><figure><img alt="Figure 1. Block Diagram for 4-to-1 Multiplexer." src="../images/4a69cdf029f3c651dadcd4508ba448a9.svg"/><figcaption>Figure 1. Block Diagram for 4-to-1 Multiplexer.</figcaption></figure>
</div></div><p data-source-line="56">You may use <code>case</code> statement or an <code>if-else</code> statement within an <code>always</code> block to describe the behavioral of the circuit, refer to
<a class="btn btn-sm btn-default" href="https://www.realdigital.org/doc/1d4a229dba3de76c709b63ca1dbabe02#step-2-design-a-multiplexer"><strong>PROJECT 4.1: Multiplexer, Decoder, Encoder, and Shifter</strong></a>. The Examples introduced in the previous project used a 4-to-1 <code>2-bit</code> <mark>Bus Multiplexer</mark>; thus, you need to modify the code so that it would be suitable for this project. Remember to create a <mark>test bench</mark> to simulate the behavioral of <mark>4-to-1 mux</mark> and make sure that it is implemented correctly.</p>
<h2 data-source-line="59" id="step-3-implement-a-de-multiplexer">Step 3: Implement a De-Multiplexer</h2>
<div class="row"><div class="col-md-8"><p>A de-multiplexer can be built using a binary decoder with an enable signal. The functional definition of a binary decoder with an enable signal is shown in Fig. 2.</p>
<pre><code class="hljs language-verilog"><span class="hljs-keyword">module</span> demux (
    En, I0, I1, Y0, Y1, Y2, Y3
);

<span class="hljs-keyword">input</span> En, I0, I1;
<span class="hljs-keyword">output</span> <span class="hljs-keyword">reg</span> Y0, Y1, Y2, Y3;

<span class="hljs-comment">// Your behavioral description of Y</span>
<span class="hljs-comment">// using if-else or case statements</span>

<span class="hljs-keyword">endmodule</span>
</code></pre>
</div><div class="col-lg-4"><figure><img alt="Figure 2. Decoder with an enable signal as a de-multiplexer" src="../images/ee025c637571e3cc39a5608dedef0307.svg"/><figcaption>Figure 2. Decoder with an enable signal as a de-multiplexer</figcaption></figure>
</div></div><p data-source-line="83">You may use <code>case</code> statement or an <code>if-else</code> statement within an <code>always</code> block to describe the behavioral of the circuit, refer to
<a class="btn btn-sm btn-default" href="https://www.realdigital.org/doc/1d4a229dba3de76c709b63ca1dbabe02#step-3-design-a-binary-decoder"><strong>PROJECT 4.1: Multiplexer, Decoder, Encoder, and Shifter</strong></a>. Remember to create a <mark>test bench</mark> to simulate the behavioral of the <mark>De-Multiplexer</mark> and make sure that it is implemented correctly.</p>
<h3 data-source-line="86" id="step-4-design-a-priority-encoder">Step 4: Design a Priority Encoder</h3>
<p data-source-line="87">In this step we are going to create the top level module, in which a mux and a de-mux will be instantiated and connected properly to form a simple time multiplexing communication system. The system diagram is shown in Fig. 3 below.</p>
<figure data-source-line="89"><img alt="Figure 3. Block Diagram of Top Level Module Wrapper" src="../images/5607a2b2c08ba0971f184db2f44bbccd.svg"/><figcaption>Figure 3. Block Diagram of Top Level Module Wrapper</figcaption></figure>
<p data-source-line="91">In the block diagram, the input/output ports of the module wrapper is in green; the input/output ports of module mux and demux is displayed in black italic; and the internal wire of wrapper module is in purple.</p>
<h3 data-source-line="93" id="declare-a-wrapper-module">Declare a Wrapper Module</h3>
<p data-source-line="94">In the project, create a new Verilog module file named <code>wrapper</code> with 4 data inputs <code>I3</code>, <code>I2</code>, <code>I1</code>, and <code>I0</code>; 2 select inputs <code>S1</code> and <code>S0</code>; and four outputs <code>Y3</code>, <code>Y2</code>, <code>Y1</code>, and <code>Y0</code>.</p>
<pre><code class="hljs language-verilog"><span class="hljs-keyword">module</span> wrapper (
    I0, I1, I2, I3, S0, S1, Y0, Y1, Y2, Y3
);

<span class="hljs-keyword">input</span> I3, I2, I1, I0, S1, S0;
<span class="hljs-keyword">output</span> Y0, Y1, Y2, Y3;

<span class="hljs-comment">// Structural Description of wrapper</span>

<span class="hljs-keyword">endmodule</span>
</code></pre>
<h3 data-source-line="109" id="declare-internal-signals">Declare Internal Signals</h3>
<p data-source-line="110">In the block diagram, there is an internal signal <code>sdata</code> which carries the time-multiplexed signal between <code>mux</code> and <code>demux</code> block. This internal signal <code>sdata</code> needs to be declared as a type <code>wire</code> before you reference it later. The declaration of internal signal should be placed after the input and output declaration.</p>
<pre><code class="hljs language-verilog"><span class="hljs-keyword">wire</span> sdata;
</code></pre>
<h3 data-source-line="116" id="instantiate-and-connect-mux-and-demux">Instantiate and Connect <code>mux</code> and <code>demux</code></h3>
<p data-source-line="117">Now you need to instantiate the <code>mux</code> that you have described in <code>mux.v</code> and connect its inputs and outputs to proper signals as shown in the block diagram above.</p>
<pre><code class="hljs language-verilog">mux input_mux (
    <span class="hljs-variable">.I3</span>(I3),
    <span class="hljs-variable">.I2</span>(I2),
    <span class="hljs-variable">.I1</span>(I1),
    <span class="hljs-variable">.I0</span>(I0),
    <span class="hljs-variable">.S1</span>(S1),
    <span class="hljs-variable">.S0</span>(S0),
    <span class="hljs-variable">.Y</span>(sdata)
);
</code></pre>
<p data-source-line="130">Similarly, you need to instantiate <code>demux</code> that you have described in <code>demux.v</code> and connect its inputs and outputs to proper signals as shown in the block diagram above.</p>
<pre><code class="hljs language-verilog">demux output_demux (
    <span class="hljs-variable">.En</span>(sdata),
    <span class="hljs-variable">.I1</span>(S1),
    <span class="hljs-variable">.I0</span>(S0),
    <span class="hljs-variable">.Y0</span>(Y0),
    <span class="hljs-variable">.Y1</span>(Y1),
    <span class="hljs-variable">.Y2</span>(Y2),
    <span class="hljs-variable">.Y3</span>(Y3)
);
</code></pre>
<h3 data-source-line="144" id="check-your-wrapper-file">Check Your Wrapper File</h3>
<p data-source-line="145">When you have completed the previous steps, your Verilog source file should look like this:</p>
<pre><code class="hljs language-verilog"><span class="hljs-keyword">module</span> wrapper (
    I0, I1, I2, I3, S0, S1, Y0, Y1, Y2, Y3
);

<span class="hljs-keyword">input</span> I3, I2, I1, I0, S1, S0;
<span class="hljs-keyword">output</span> Y0, Y1, Y2, Y3;

<span class="hljs-comment">// Structural Description of wrapper</span>
<span class="hljs-keyword">wire</span> sdata;

mux input_mux (
    <span class="hljs-variable">.I3</span>(I3),
    <span class="hljs-variable">.I2</span>(I2),
    <span class="hljs-variable">.I1</span>(I1),
    <span class="hljs-variable">.I0</span>(I0),
    <span class="hljs-variable">.S1</span>(S1),
    <span class="hljs-variable">.S0</span>(S0),
    <span class="hljs-variable">.Y</span>(sdata)
);

demux output_demux (
    <span class="hljs-variable">.En</span>(sdata),
    <span class="hljs-variable">.I1</span>(S1),
    <span class="hljs-variable">.I0</span>(S0),
    <span class="hljs-variable">.Y0</span>(Y0),
    <span class="hljs-variable">.Y1</span>(Y1),
    <span class="hljs-variable">.Y2</span>(Y2),
    <span class="hljs-variable">.Y3</span>(Y3)
);

<span class="hljs-keyword">endmodule</span>
</code></pre>
<h2 data-source-line="180" id="step-5-create-an-xdc-file-and-generate-bitstream">Step 5: Create an XDC File and Generate Bitstream</h2>
<h3 data-source-line="181" id="create-an-xdc-file">Create an XDC File</h3>
<p data-source-line="182">Now, create an XDC file and connect inputs <code>I3</code> to <mark>SW3</mark>, <code>I2</code> to <mark>SW2</mark>, <code>I1</code> to <mark>SW1</mark>, <code>I0</code> to <mark>SW0</mark>, <code>S1</code> to <mark>BTN1</mark>, <code>S0</code> to <mark>BTN0</mark>, and outputs <code>Y3</code> to <mark>LED3</mark>, <code>Y2</code> to <mark>LED2</mark>, <code>Y1</code> to <mark>LED1</mark>, <code>Y0</code> to <mark>LED0</mark>.</p>
<h3 data-source-line="183" id="generate-bitstream">Generate Bitstream</h3>
<p data-source-line="184">After you’ve completed the xdc file, you can go ahead an generate the bitstream.</p>
<h2 data-source-line="186" id="requirement">Requirement</h2>
<h3 data-source-line="188" id="1-mux-and-demux-circuit"><i aria-hidden="true" class="fa fa-check-square-o"></i> 1. Mux and Demux circuit</h3>
<p data-source-line="189">Program your Blackboard with the generated bitstream and demonstrate your design.</p>
<h2 data-source-line="191" id="challenge">Challenge</h2>
<h3 data-source-line="192" id="1-finish-a-real-communication-system"><i aria-hidden="true" class="fa fa-plus-square"></i> 1. Finish a Real Communication System</h3>
<p data-source-line="193">The block design of your module will look as follows:</p>
<figure data-source-line="195"><img alt="Figure 4. Block diagram of a transmission system" src="../images/05b565a3c570019baab4240c23a8ec06.svg"/><figcaption>Figure 4. Block diagram of a transmission system</figcaption></figure>
<p data-source-line="197">To finish a real communication you need to implement a module (“counter”) that can cycle through 00, 01, 10, 11 for S1 and S0 automatically, and another module (“latch”) to hold the data. (Counters and latches will be discussed in future projects.) So, here are two Verilog modules that you can use that help you do this:</p>
<pre><code class="hljs language-verilog"><span class="hljs-keyword">module</span> counter (
	<span class="hljs-keyword">input</span> clk,
	<span class="hljs-keyword">output</span> Y1, Y0
);

<span class="hljs-keyword">reg</span> [<span class="hljs-number">27</span>:<span class="hljs-number">0</span>] counter;

<span class="hljs-keyword">always</span> @ (<span class="hljs-keyword">posedge</span> clk)
<span class="hljs-keyword">begin</span>
	counter &lt;= counter + <span class="hljs-number">1</span>;
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">assign</span> Y1 = counter[<span class="hljs-number">27</span>];
<span class="hljs-keyword">assign</span> Y0 = counter[<span class="hljs-number">26</span>];

<span class="hljs-keyword">endmodule</span>
</code></pre>
<pre><code class="hljs language-verilog"><span class="hljs-keyword">module</span> latch (
    <span class="hljs-keyword">input</span> [<span class="hljs-number">3</span>:<span class="hljs-number">0</span>] I,
    <span class="hljs-keyword">input</span> [<span class="hljs-number">1</span>:<span class="hljs-number">0</span>] S,
    <span class="hljs-keyword">output</span> <span class="hljs-keyword">reg</span> [<span class="hljs-number">3</span>:<span class="hljs-number">0</span>] O
);

<span class="hljs-keyword">always</span> @ (I, S)
    <span class="hljs-keyword">case</span> (S)
    <span class="hljs-number">2'b00</span>:
        O = {O[<span class="hljs-number">3</span>:<span class="hljs-number">1</span>], I[<span class="hljs-number">0</span>]};
    <span class="hljs-number">2'b01</span>:
        O = {O[<span class="hljs-number">3</span>], O[<span class="hljs-number">2</span>], I[<span class="hljs-number">1</span>], O[<span class="hljs-number">0</span>]};
    <span class="hljs-number">2'b10</span>:
        O = {O[<span class="hljs-number">3</span>], I[<span class="hljs-number">2</span>], O[<span class="hljs-number">1</span>], O[<span class="hljs-number">0</span>]};
    <span class="hljs-number">2'b11</span>:
        O = {I[<span class="hljs-number">3</span>], O[<span class="hljs-number">2</span>:<span class="hljs-number">0</span>]};
    <span class="hljs-keyword">default</span>:
        O = O;
    <span class="hljs-keyword">endcase</span>
<span class="hljs-keyword">endmodule</span>
</code></pre>
<p data-source-line="239">You will also need to create a top module <code>wrapper</code> that connects all the components as displayed in Fig. 4, and create an XDC file to map inputs <code>I3</code> to <mark>SW3</mark>, <code>I2</code> to <mark>SW2</mark>, <code>I1</code> to <mark>SW1</mark>, <code>I0</code> to <mark>SW0</mark>, <code>clk</code> to onboard <mark>100MHz clock</mark>, and outputs <code>Y3</code> to <mark>LED3</mark>, <code>Y2</code> to <mark>LED2</mark>, <code>Y1</code> to <mark>LED1</mark>, <code>Y0</code> to <mark>LED0</mark>, and <code>tData</code> to <mark>LED7</mark>(any color).</p>
<h2 data-source-line="241" id="next-project-seven-segment-encoder"><i aria-hidden="true" class="fa fa-sign-out"></i> Next Project: Seven Segment Encoder</h2>
<p data-source-line="243">If you are confident in doing this project, go ahead and continue with the next <a class="btn btn-sm btn-default" href="https://www.realdigital.org/doc/361339eab38546c74161d53e5713289a"><strong>PROJECT 4.3: Seven Segment Display Encoder</strong></a> for some extra practice!</p>
</div>
<div class="col col-toc">
<nav class="sticky-top sticky" id="doc-toc">
</nav>
</div>
</div>
</article>
</div>
<div aria-hidden="true" aria-labelledby="imagePreview" class="modal fade" id="docImagePreviewModal" role="dialog" tabindex="-1">
<div class="modal-dialog modal-lg" role="document" style="max-width: 80vw;">

</div>
</div>
</div>
<footer class="page-footer center-on-small-only">
<div class="container-fluid">
<div class="footer-copyright">
            Copyright © 2018 realdigital.org. All Rights Reserved.<br/>
            Documents licensed <a href="http://creativecommons.org/licenses/by-sa/4.0/" rel="license">CC SA 4.0</a>.
        </div>
</div>
</footer>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js" type="text/javascript"></script>
<script src="/build/manifest.d41d8cd98f00b204e980.js" type="text/javascript"></script>
<script src="/build/realdigital.de4335d491c4f4582d5e.js" type="text/javascript"></script>
<script src="/build/js/app.b4b1f84db5840c3f9f81.js" type="text/javascript"></script>
<script>new WOW().init();</script>
</body>
</html>
